\chapter{Software Implementation}
    \section{QUANTUM ESPRESSO}
    The Quantum opEn  Source  Package  for  Research  in  Electronic  Structure, Simulation, and Optimization (QUANTUM ESPRESSO) is an integrated suite of open source codes for electronic structure calculations and materials modeling based on Density functional theory, plane waves, and pseudopotential approach \citep{Giannozzi2009,Giannozzi2017}. The code is written in FORTRAN which offers an advanced programming with high-performance computing capabilities. The code can take advantage of parallelization that can delegate calculation tasks that leads to substantial decrease in computational time. Quantum ESPRESSO can do several computations including, but not limited to, ground state calculations, structural optimizations, response properties, spectroscopic properties, and quantum transport. 
        % \subsection{MKL Libraries}
        % \subsection{PWSCF routines}
            % cbands, cegterg, cdiaghg 
    % \section{Intel Compilers}
    
    \section{Executables}
    \textcolor{red}{insert text
    }
    \section{Computational Details}
    This section outlines the computational recipes of successfully simulating material properties using Density Functional Theory executed in  Quantum Espresso code. 

    \subsection{Pseudopotential}
    This thesis used the Garrity-Bennett-Rabe-Vanderbilt (GBRV) ultrasoft pseudopotential library that was designed at Rutgers university \citep{Garrity2014}. The pseudopotential was generated using GGA exchangeâ€“correlation correlation functional based on Perdew-Burke-Ernzerhof (PBE) functional \citep{Perdew1996}. For the $\ch{Zn}$ atom, the pseudopotential included 3s, 3p, 3d, 4s orbitals for valence calculations  while the inner core orbitals were approximated using an ultrasoft pseudopotential. The 3s and 3p orbitals are considered as "semi-core" orbitals since they do not participate on chemical bonding but were included only in electronic structure calculations. For the O atom, only  2s and 2p orbitals were taken into account. Thus, Zn has 20 valence electrons while O has 6 valence electrons. 

    \subsection{Convergence Testing}
    The optimum values of the k-points, and kinetic energy-cutoffs  of  Kohn-Sham orbitals and electron density to be used in subsequent calculations were determine from convergence tests. Initially, k-points were varied for a fixed plane wave cutoff energy and electron density cutoff energy. These fixed values were set at $E_{\text{wfc}} = 40$ Ry and $E_{\text{rho}} = 320$ Ry, which are the suggested minimum values set by the pseudopotential used \citep{Garrity2014}.  Since the c-axis of \ch{ZnO} unit cell is longer, as shown in Figure \ref{fig:ZnO_unit}, its corresponding reciprocal lattice is smaller. Hence, the grid points in the $k_z$ direction were scaled down properly. The Monkhorst-Pack grid centered at $\Gamma$ point was set at $(k+5) \times (k +5 ) \times k$. After finding the optimum k-point, the energy cutoff $E_{wfc}$ of the Kohn-Sham orbital was varied. The energy cutoff of the electron density $E_{rho}$ was maintained at $8 \times E_{wfc}$, where dual $=8$ is a multiplier of $E_{wfc}$. Lastly, the $E_{rho}$ was varied by changing its dual with respect to the optimized k-point $k$ and plane wave cutoff energy $E_{wfc}$ until desired material properties did not change. The material properties investigated in the convergence tests were total energy and pressure since both are sensitive to the parameters given above. 

    \subsection{Supercell generation}
    The supercell is generated from the stacking of hexagonal \ch{ZnO} unit cell as  shown in Figure \ref{fig:ZnO_unit}. A $3 \times 3 \times 2$ supercell was used in terms of four distinct atoms in the unit cell. Thus, the supercell consists in total of 72 atoms. Vacancies were simulated by removing an atom from the crystal lattice while interstitials were simulated by adding atoms in the voids of the crystal lattice. Antisites, where O atom is replaced by Zn atom and vice versa, were also modeled. Lastly, charged defects were modeled by removing one or two electrons from the crystal system. Since the volume of supercell is larger than its unit cell, the resulting supercell in the reciprocal space is much smaller. Hence, the k-points were scaled down to $2 \times 2 \times 2$ Monkhorst-Pack grid.  

    \subsection{Hubbard correction parameters}
    Hubbard-U correction was applied to treat the strong correlation of the 2p and 3d states present in \ch{ZnO}. Specifically, the U parameter of 2p and 3d orbitals, denoted as $U_{p}$ and $U_{d}$, were empirically tuned until the calculated band gap matches the experimental band gap. The obtained value will be used throughout the course of simulation.  

    \subsection{Structural relaxation}
    The positions of the atoms in the unit cell of ZnO was based on experimental measurements.  To accurately describe the system, the forces must be negligible. The geometry of the system was optimized by relaxing all atomic positions within the supercell subject to the following criteria: the total energy changes by less than the threshold of $1 \times 10^{-5}$ Ry between two consecutive scf steps, and the total force is less than the force threshold of $1 \times 10^{-4}$ Ry/bohr. 

    \subsection{SCF calculation}
        Since the optimum values of k-points and cutoff energies were determined from the convergence tests, the main program of Quantum Espresso which is the self-consistent field calculation can proceed smoothly. The flow diagram of the SCF calculation together with the structural relaxation is shown in Figure \ref{fig:ionic_relax}. The convergence threshold for the scf calculation was set at $1 \times 10^{-6}$. If the change in electron density was below this threshold, the electron density is the ground state density and pertinent properties such as total energy can be calculated. Broyden charge density mixing was used as a mixing mode to update the charge density with  $\alpha = 0.4$ as the mixing parameter.   The occupations were smoothed by a gaussian smearing with a broadening factor of 0.001 Ry. 





        \subsection{Bandstructure calculation}
        \subsection{dos calculation}

DOST COARE